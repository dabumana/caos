name: Integration

on:
  push:
    branches: [ "main", "developer" ]
  pull_request:
    branches: [ "main", "developer" ]

jobs:

  build-coverage:
    name: Build // Coverage
    runs-on: ${{ 'macos-latest' || 'ubuntu-latest' || 'windows-latest' }}
    steps:
      - name: Set up Go
        uses: actions/setup-go@v3
        with:
          go-version: 1.20

      - name: Checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
          persist-credentials: false

      - name: Dependencies
        run: sudo apt-get install libcurl4-openssl-dev

      - name: Build
        run: make build APP=caos
      
      - name: Coverage
        run: make test
